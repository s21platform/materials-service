syntax = "proto3";

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

option go_package = "pkg/materials";

service MaterialsService {
  rpc SaveDraftMaterial(SaveDraftMaterialIn) returns (SaveDraftMaterialOut){};
  rpc GetMaterial(GetMaterialIn) returns (GetMaterialOut) {};
  rpc GetAllMaterials(google.protobuf.Empty) returns (GetAllMaterialsOut){};
  rpc EditMaterial(EditMaterialIn) returns (EditMaterialOut) {};
  rpc PublishMaterial(PublishMaterialIn) returns (PublishMaterialOut){};
  rpc DeleteMaterial(DeleteMaterialIn) returns (google.protobuf.Empty) {};
  rpc ArchivedMaterial(ArchivedMaterialIn) returns (google.protobuf.Empty) {};
  rpc ToggleLike(ToggleLikeIn) returns (ToggleLikeOut) {};
}

message SaveDraftMaterialIn {
  string title = 1;             // Заголовок материала
  string cover_image_url = 2;   // URL обложки материала
  string description = 3;       // Описание материала
  string content = 4;           // Содержимое материала
  int32 read_time_minutes = 5;  // Время чтения в минутах
}

message SaveDraftMaterialOut {
  string uuid = 1;     // UUID созданного материала
}

message GetMaterialIn {
  string uuid = 1; // UUID материала
}

message GetMaterialOut {
  Material material = 1; // Весь материал
}

message Material {
  string uuid = 1;
  string owner_uuid = 2;                       // UUID владельца материала
  string title = 3;                            // Заголовок материала
  string cover_image_url = 4;                  // URL обложки материала
  string description = 5;                      // Описание материала
  string content = 6;                          // Содержимое материала
  int32 read_time_minutes = 7;                 // Время чтения в минутах
  string status = 8;                           // Статус материала
  google.protobuf.Timestamp created_at = 9;    // Время создания
  google.protobuf.Timestamp edited_at = 10;    // Время последнего редактирования
  google.protobuf.Timestamp published_at = 11; // Время публикации
  google.protobuf.Timestamp archived_at = 12;  // Время архивации
  google.protobuf.Timestamp deleted_at = 13;   // Время удаления
  int32 likes_count = 14;                      // Количество лайков
}

message GetAllMaterialsOut {
  repeated Material material_list = 1;
}

message EditMaterialIn {
  string uuid = 1;             // UUID материала
  string title = 2;            // Заголовок материала
  string cover_image_url = 3;  // URL обложки материала
  string description = 4;      // Описание материала
  string content = 5;          // Содержание материала
  int32 read_time_minutes = 6; // Время чтения в минутах
}

message EditMaterialOut {
  Material material = 1; // Весь материал
}

message DeleteMaterialIn{
  string uuid = 1;
}

message PublishMaterialIn{
  string uuid = 1; // UUID материала
}

message PublishMaterialOut{
  Material material = 1; // Весь материал
}

message ArchivedMaterialIn{
  string uuid = 1;
}

message ToggleLikeIn {
  string material_uuid = 1; // UUID материала
}

message ToggleLikeOut {
  bool is_liked = 1;     // Состояние лайка
  int32 likes_count = 2; // Количество лайков
}

message MaterialDeletedMessage {
  string uuid = 1;
  string owner_uuid = 2;
  google.protobuf.Timestamp deleted_at = 4;
}